# E2E BDD Testing Guide

> –†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Dom Iskusstv. –ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥—Ö–æ–¥–æ–≤ –¥–ª—è –±—É–¥—É—â–∏—Ö E2E —Ç–µ—Å—Ç–æ–≤.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```
tests/e2e/
‚îú‚îÄ‚îÄ features/                    # Gherkin —Å—Ü–µ–Ω–∞—Ä–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ dom_iskusstv.feature     # BDD —Å—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ steps/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bot_steps.py         # Step definitions
‚îÇ   ‚îî‚îÄ‚îÄ environment.py           # Behave hooks (before/after)
‚îú‚îÄ‚îÄ human_client.py              # HumanUserClient wrapper
‚îî‚îÄ‚îÄ conftest.py                  # Pytest fixtures
```

### –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|
| `HumanUserClient` | Telethon wrapper —Å human-like –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º |
| `behave` | BDD framework –¥–ª—è Gherkin —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ |
| `bot_steps.py` | –®–∞–≥–∏ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–æ—Ç–æ–º |

---

## –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –§–æ—Ä–º–∞—Ç Gherkin (—Ä—É—Å—Å–∫–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å)

```gherkin
# language: ru
–§—É–Ω–∫—Ü–∏—è: –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π —Å –î–æ–º–∞ –∏—Å–∫—É—Å—Å—Ç–≤

  –°—Ü–µ–Ω–∞—Ä–∏–π: –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π –ø–æ —Å—Å—ã–ª–∫–µ
    –î–∞–Ω–æ —è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ –∫–ª–∏–µ–Ω—Ç–µ Telethon
    –ò —è –æ—Ç–∫—Ä—ã–ª —á–∞—Ç —Å –±–æ—Ç–æ–º
    –ö–æ–≥–¥–∞ —è –æ—Ç–ø—Ä–∞–≤–ª—è—é –∫–æ–º–∞–Ω–¥—É "/start"
    –ò —è –∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ç–µ–∫—Å—Ç–æ–º "Choose action"
    –¢–æ–≥–¥–∞ –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–Ω–æ–ø–∫–∞ "üèõ –î–æ–º –∏—Å–∫—É—Å—Å—Ç–≤"
```

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã —à–∞–≥–æ–≤

#### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
```python
@when('—è –æ—Ç–ø—Ä–∞–≤–ª—è—é –∫–æ–º–∞–Ω–¥—É "{cmd}"')
@when('—è –æ—Ç–ø—Ä–∞–≤–ª—è—é —Å–æ–æ–±—â–µ–Ω–∏–µ "{text}"')
```

#### –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞
```python
@then('—è –∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ç–µ–∫—Å—Ç–æ–º "{text}"')
@then('—è –∂–¥—É –¥–æ–ª–≥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ç–µ–∫—Å—Ç–æ–º "{text}"')  # –¥–æ 5 –º–∏–Ω—É—Ç
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–æ–∫
```python
@then('–ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–Ω–æ–ø–∫–∞ "{btn}"')
@then('–ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–Ω–æ–ø–∫–∏: "{buttons}"')  # —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
```

#### –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–æ–∫
```python
@when('—è –Ω–∞–∂–∏–º–∞—é –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫—É "{btn}"')
```

---

## –†–∞–±–æ—Ç–∞ —Å –¥–æ–ª–≥–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

### –ü—Ä–æ–±–ª–µ–º–∞
Kaggle notebook –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è 2-5 –º–∏–Ω—É—Ç. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π timeout –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω.

### –†–µ—à–µ–Ω–∏–µ
```python
@then('—è –∂–¥—É –¥–æ–ª–≥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ç–µ–∫—Å—Ç–æ–º "{text}"')
def step_wait_long_operation(context, text):
    """Wait up to 5 minutes for long operations like Kaggle."""
    async def _wait():
        for i in range(600):  # 5 –º–∏–Ω—É—Ç = 600 * 0.5s
            messages = await context.client.client.get_messages(
                context.bot_entity, limit=10
            )
            for msg in messages:
                if msg.text and text.lower() in msg.text.lower():
                    context.last_response = msg
                    return
            await asyncio.sleep(0.5)
        raise AssertionError(f"–°–æ–æ–±—â–µ–Ω–∏–µ '{text}' –Ω–µ –ø–æ–ª—É—á–µ–Ω–æ –∑–∞ 5 –º–∏–Ω—É—Ç")
    run_async(context, _wait())
```

### –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã
- Polling –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫—É–Ω–¥—ã –≤–º–µ—Å—Ç–æ –±–ª–æ–∫–∏—Ä—É—é—â–µ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ)
- Case-insensitive –ø–æ–∏—Å–∫ —Ç–µ–∫—Å—Ç–∞

---

## –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ Telegraph

### –ü—Ä–æ–±–ª–µ–º–∞
–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∏–µ —Å—Å—ã–ª–∫–∏, –Ω–æ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

### –†–µ—à–µ–Ω–∏–µ
```python
@then('–∫–∞–∂–¥–∞—è Telegraph —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å "{required_text}"')
def step_verify_telegraph_content(context, required_text):
    """Verify content on all Telegraph pages."""
    items = [x.strip() for x in required_text.split(",")]
    
    async def _verify():
        async with aiohttp.ClientSession() as session:
            for link in context.telegraph_links:
                async with session.get(link) as resp:
                    html = await resp.text()
                    html_lower = html.lower()
                    for item in items:
                        if item.lower() not in html_lower:
                            raise AssertionError(
                                f"'{item}' –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ {link}"
                            )
    run_async(context, _verify())
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```gherkin
–ò –∫–∞–∂–¥–∞—è Telegraph —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å "üéü, –ë–∏–ª–µ—Ç—ã, —Ä—É–±."
```

---

## –û—Ç–ª–∞–¥–∫–∞ –æ—à–∏–±–æ–∫

### PAGE_ACCESS_DENIED

**–°–∏–º–ø—Ç–æ–º:** Telegraph —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è, —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ.

**–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∞ —Å –¥—Ä—É–≥–∏–º `access_token`.

**–†–µ—à–µ–Ω–∏–µ:** Fallback ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ –æ—à–∏–±–∫–µ:
```python
try:
    await telegraph_edit_page(...)
except Exception as e:
    if "PAGE_ACCESS_DENIED" in str(e):
        ev.telegraph_path = None  # Clear to create new
        # Create new page...
```

### –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ step definitions

**–°–∏–º–ø—Ç–æ–º:** `AmbiguousStep` –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ behave.

**–ü—Ä–∏—á–∏–Ω–∞:** –û–¥–∏–Ω —à–∞–≥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –¥–≤–∞–∂–¥—ã (—Ä–∞–∑–Ω—ã–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã).

**–†–µ—à–µ–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ –æ–¥–∏–Ω decorator:
```python
# ‚ùå –ë—ã–ª–æ:
@then("—è –ª–æ–≥–∏—Ä—É—é...")
def step1(ctx): ...

@when("—è –ª–æ–≥–∏—Ä—É—é...")  
def step1(ctx): ...  # –î—É–±–ª–∏–∫–∞—Ç!

# ‚úÖ –°—Ç–∞–ª–æ:
@then("—è –ª–æ–≥–∏—Ä—É—é...")
@when("—è –ª–æ–≥–∏—Ä—É—é...")
def step_log(ctx): ...
```

### FloodWait –æ—Ç Telegram

**–°–∏–º–ø—Ç–æ–º:** `Sleeping for Xs on GetHistoryRequest flood wait`

**–ü—Ä–∏—á–∏–Ω–∞:** –°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API.

**–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª polling, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å human-like delays.

---

## –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è –Ω–æ–≤–æ–≥–æ E2E —Ç–µ—Å—Ç–∞

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ —Å `DB_PATH=db_prod_snapshot.sqlite`
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `/start`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å production –±–æ—Ç–æ–º

### –ù–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞
- [ ] –°–æ–∑–¥–∞—Ç—å `.feature` —Ñ–∞–π–ª —Å Gherkin —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä—É—Å—Å–∫–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å (`# language: ru`)
- [ ] –î–æ–±–∞–≤–∏—Ç—å —à–∞–≥–∏ –≤ `bot_steps.py` –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –Ω–æ–≤—ã–µ

### –ó–∞–ø—É—Å–∫
```bash
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
DB_PATH=db_prod_snapshot.sqlite python3 main.py &

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
behave tests/e2e/features/your_feature.feature --no-capture
```

### –û—Ç–ª–∞–¥–∫–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –±–æ—Ç–∞ (`bot.log`)
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `—è –ª–æ–≥–∏—Ä—É—é –≤ –∫–æ–Ω—Å–æ–ª—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å HTTP –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Telegraph —Å—Å—ã–ª–æ–∫

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∞

### –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –¥–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö (Kaggle) –≤–∞–∂–Ω–æ –≤–∏–¥–µ—Ç—å —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –±–æ—Ç–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å —Ç–µ—Å—Ç–æ–º, —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–µ–µ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –æ—à–∏–±–∫–∏.

### –†–µ—à–µ–Ω–∏–µ: –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ó–∞–ø—É—Å–∫–∞–µ–º —Ç—Ä–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞/–ø—Ä–æ—Ü–µ—Å—Å–∞:

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1: –ë–æ—Ç
DB_PATH=db_prod_snapshot.sqlite python3 main.py 2>&1 | tee bot.log

# –¢–µ—Ä–º–∏–Ω–∞–ª 2: –¢–µ—Å—Ç —Å –∑–∞–ø–∏—Å—å—é –≤ —Ñ–∞–π–ª
behave tests/e2e/features/dom_iskusstv.feature --no-capture 2>&1 | tee test_output.txt

# –¢–µ—Ä–º–∏–Ω–∞–ª 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –±–æ—Ç–∞
tail -f bot.log | grep -E "ERROR|WARNING|Kaggle|Telegraph|PAGE_ACCESS"
```

### –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è grep

```bash
# –û—à–∏–±–∫–∏ Telegraph
tail -f bot.log | grep -E "PAGE_ACCESS_DENIED|telegraph_edit|CONTENT_TOO_BIG"

# Kaggle —Å—Ç–∞—Ç—É—Å
tail -f bot.log | grep -E "Kaggle|kernel|notebook|running|complete"

# –û–±—â–∏–µ –æ—à–∏–±–∫–∏
tail -f bot.log | grep -E "ERROR|Exception|Traceback"

# Dom Iskusstv —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ
tail -f bot.log | grep -E "dom_iskusstv|parse_dom|skazka"
```

### –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ polling

–í–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –¥–æ–ª–≥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–∞–∂–¥—ã–µ 30-60 —Å–µ–∫—É–Ω–¥ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ:

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –ª–æ–≥–∞
tail -n 20 bot.log

# –°—Ç–∞—Ç—É—Å Telegraph fallback
grep -c "PAGE_ACCESS_DENIED" bot.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTP —Å—Å—ã–ª–æ–∫ –∏–∑ –ª–æ–≥–∞
grep -oE "https://telegra\.ph/[^ ]+" bot.log | tail -5 | xargs -I{} curl -sI {} | grep HTTP
```

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

```bash
#!/bin/bash
# monitor_e2e.sh

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ —Ñ–æ–Ω–µ
DB_PATH=db_prod_snapshot.sqlite python3 main.py > bot.log 2>&1 &
BOT_PID=$!
echo "Bot started: PID=$BOT_PID"

# –ñ–¥—ë–º —Å—Ç–∞—Ä—Ç–∞
sleep 5

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –≤ —Ñ–æ–Ω–µ
behave tests/e2e/features/$1 --no-capture > test_output.txt 2>&1 &
TEST_PID=$!
echo "Test started: PID=$TEST_PID"

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
while kill -0 $TEST_PID 2>/dev/null; do
    echo "=== $(date) ==="
    tail -n 5 bot.log | grep -v "^$"
    echo "---"
    sleep 30
done

# –†–µ–∑—É–ª—å—Ç–∞—Ç
echo "Test finished. Exit code: $(wait $TEST_PID; echo $?)"
tail -n 20 test_output.txt
kill $BOT_PID 2>/dev/null
```

### –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö

| –õ–æ–≥-–ø–∞—Ç—Ç–µ—Ä–Ω | –ó–Ω–∞—á–µ–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ |
|-------------|----------|----------|
| `PAGE_ACCESS_DENIED` | –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Telegraph | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fallback |
| `Kaggle kernel running` | Notebook –∑–∞–ø—É—â–µ–Ω | –ñ–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è |
| `CONTENT_TOO_BIG` | –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∞—è | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å compact mode |
| `FloodWait` | Telegram rate limit | –£–≤–µ–ª–∏—á–∏—Ç—å delays |
| `event_id=` | –°–æ–±—ã—Ç–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Telegraph URL |

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| `Timeout` | Kaggle –¥–æ–ª–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `—è –∂–¥—É –¥–æ–ª–≥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏` |
| `AmbiguousStep` | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ step definitions | –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã |
| `PAGE_ACCESS_DENIED` | –ß—É–∂–æ–π access_token | –î–æ–±–∞–≤–∏—Ç—å fallback —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã |
| `message is too long` | > 4096 —Å–∏–º–≤–æ–ª–æ–≤ | –î–æ–±–∞–≤–∏—Ç—å compact fallback |
| `FloodWait` | –ß–∞—Å—Ç—ã–µ API –∑–∞–ø—Ä–æ—Å—ã | –£–≤–µ–ª–∏—á–∏—Ç—å delays |

---

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å snapshot –ë–î, –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å production
2. **Human-like –ø–æ–≤–µ–¥–µ–Ω–∏–µ** ‚Äî —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è Telegram
3. **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî `[REPORT]` –±–ª–æ–∫–∏ –¥–ª—è debug
4. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞** ‚Äî –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞–ª–∏—á–∏–µ, –Ω–æ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
5. **Graceful degradation** ‚Äî fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API
6. **Timeout –¥–ª—è Kaggle** ‚Äî –º–∏–Ω–∏–º—É–º 5 –º–∏–Ω—É—Ç –¥–ª—è notebook –æ–ø–µ—Ä–∞—Ü–∏–π

---

## –ü—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –ë–∞–∑–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π
```gherkin
–°—Ü–µ–Ω–∞—Ä–∏–π: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ –º–µ–Ω—é
  –î–∞–Ω–æ —è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ –∫–ª–∏–µ–Ω—Ç–µ Telethon
  –ò —è –æ—Ç–∫—Ä—ã–ª —á–∞—Ç —Å –±–æ—Ç–æ–º
  –ö–æ–≥–¥–∞ —è –æ—Ç–ø—Ä–∞–≤–ª—è—é –∫–æ–º–∞–Ω–¥—É "/start"
  –ò —è –∂–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ç–µ–∫—Å—Ç–æ–º "Choose action"
  –¢–æ–≥–¥–∞ –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–Ω–æ–ø–∫–∞ "üèõ –î–æ–º –∏—Å–∫—É—Å—Å—Ç–≤"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π —Å –¥–æ–ª–≥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π
```gherkin
–°—Ü–µ–Ω–∞—Ä–∏–π: –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–±—ã—Ç–∏–π
  –î–∞–Ω–æ —è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ –∫–ª–∏–µ–Ω—Ç–µ Telethon
  –ò —è –æ—Ç–∫—Ä—ã–ª —á–∞—Ç —Å –±–æ—Ç–æ–º
  –ö–æ–≥–¥–∞ —è –æ—Ç–ø—Ä–∞–≤–ª—è—é —Å–æ–æ–±—â–µ–Ω–∏–µ "https://example.com/events"
  –¢–æ–≥–¥–∞ —è –∂–¥—É –¥–æ–ª–≥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ç–µ–∫—Å—Ç–æ–º "–∏–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω"
  –ò —è –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –≤ –æ—Ç–≤–µ—Ç–µ –¥–µ–π—Å—Ç–≤—É—é—â—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–µ–ª–µ–≥—Ä–∞—Ñ
  –ò –∫–∞–∂–¥–∞—è Telegraph —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å "üéü, –ë–∏–ª–µ—Ç—ã, —Ä—É–±."
```

### –°—Ü–µ–Ω–∞—Ä–∏–π —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–Ω–æ–ø–æ–∫
```gherkin
–°—Ü–µ–Ω–∞—Ä–∏–π: –ü—Ä–æ–≤–µ—Ä–∫–∞ VK –º–µ–Ω—é
  –ö–æ–≥–¥–∞ —è –æ—Ç–ø—Ä–∞–≤–ª—è—é –∫–æ–º–∞–Ω–¥—É "/vk"
  –¢–æ–≥–¥–∞ –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–Ω–æ–ø–∫–∏: "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–±—ã—Ç–∏—è, üèõ –ò–∑–≤–ª–µ—á—å –∏–∑ –î–æ–º –∏—Å–∫—É—Å—Å—Ç–≤"
```
