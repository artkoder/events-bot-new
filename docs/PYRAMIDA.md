# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∏–∑ Pyramida

## –û–±–∑–æ—Ä

–§—É–Ω–∫—Ü–∏—è "–ò–∑–≤–ª–µ—á—å –∏–∑ Pyramida" –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—Ä—Å–∏—Ç—å —Å–æ–±—ã—Ç–∏—è —Å —Å–∞–π—Ç–∞ pyramida.info –ø–æ —Å—Å—ã–ª–∫–∞–º, –Ω–∞–π–¥–µ–Ω–Ω—ã–º –≤ VK –ø–æ—Å—Ç–∞—Ö.

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/vk` ‚Üí **üîé –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–±—ã—Ç–∏—è**
2. –ü—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –ø–æ—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ `pyramida.info/tickets/...`, –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ **üîÆ –ò–∑–≤–ª–µ—á—å –∏–∑ Pyramida (N)**
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è Kaggle notebook –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
4. –ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Å–æ–±—ã—Ç–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü—É—Ç—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------|------------|
| Kaggle notebook | `kaggle/ParsePyramida/` | –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü pyramida.info —á–µ—Ä–µ–∑ Playwright |
| Python –º–æ–¥—É–ª—å | `source_parsing/pyramida.py` | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ URL, –∑–∞–ø—É—Å–∫ Kaggle, –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ |
| VK Review UI | `main_part2.py` | –ö–Ω–æ–ø–∫–∞ –∏ callback handler |

### –§–æ—Ä–º–∞—Ç —Å—Å—ã–ª–æ–∫

–ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –≤—Å–µ —Å—Å—ã–ª–∫–∏ –≤–∏–¥–∞:
```
https://pyramida.info/tickets/[slug]
https://www.pyramida.info/tickets/[slug]
http://pyramida.info/tickets/[slug]
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

```json
[
  {
    "title": "–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è",
    "date_raw": "28 –¥–µ–∫–∞–±—Ä—è 18:00",
    "location": "–ö–æ–Ω—Ü–µ—Ä—Ç–Ω—ã–π –∑–∞–ª",
    "price": "–æ—Ç 500 ‚ÇΩ",
    "age_restriction": "6+",
    "ticket_status": "available",
    "url": "https://pyramida.info/tickets/...",
    "image_url": "https://pyramida.info/upload/...",
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è..."
  }
]
```

### –ü–æ–ª—è TheatreEvent

| –ü–æ–ª–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| `title` | H1 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ | –ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è |
| `date_raw` | –ü–æ–ª–µ "–î–∞—Ç–∞" | –°—ã—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ —Å –¥–∞—Ç–æ–π |
| `parsed_date` | –ü–∞—Ä—Å–∏–Ω–≥ date_raw | ISO –¥–∞—Ç–∞ (YYYY-MM-DD) |
| `parsed_time` | –ü–∞—Ä—Å–∏–Ω–≥ date_raw | –í—Ä–µ–º—è (HH:MM) |
| `location` | –ü–æ–ª–µ "–ú–µ—Å—Ç–æ" | –ü–ª–æ—â–∞–¥–∫–∞ |
| `ticket_status` | –ù–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–∫–∏ "–ö—É–ø–∏—Ç—å" | available/sold_out/unknown |
| `url` | –í—Ö–æ–¥–Ω–∞—è —Å—Å—ã–ª–∫–∞ | –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É –±–∏–ª–µ—Ç–æ–≤ |
| `photos` | image_url | –û–±–ª–æ–∂–∫–∞ —Å–æ–±—ã—Ç–∏—è |
| `description` | –ü–æ–ª–µ "–û–ø–∏—Å–∞–Ω–∏–µ" | –¢–µ–∫—Å—Ç –æ–ø–∏—Å–∞–Ω–∏—è (–¥–æ 1000 —Å–∏–º–≤–æ–ª–æ–≤) |

### –°—Ç–∞—Ç—É—Å—ã –±–∏–ª–µ—Ç–æ–≤

| –°—Ç–∞—Ç—É—Å | –£—Å–ª–æ–≤–∏–µ |
|--------|---------|
| `available` | –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "–ö—É–ø–∏—Ç—å" |
| `registration_open` | –¢–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç "—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è" + "–ø—Ä–æ–π—Ç–∏/–Ω–µ–æ–±—Ö–æ–¥–∏–º–∞" |
| `sold_out` | –¢–µ–∫—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç "–±–∏–ª–µ—Ç–æ–≤ –Ω–µ—Ç" |
| `unknown` | –ù–∏ –æ–¥–Ω–æ —É—Å–ª–æ–≤–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ |

## –û—Ç–ª–∏—á–∏—è –æ—Ç /parse

| –ê—Å–ø–µ–∫—Ç | /parse | –ò–∑–≤–ª–µ—á—å –∏–∑ Pyramida |
|--------|--------|---------------------|
| –ò—Å—Ç–æ—á–Ω–∏–∫ | –¢–µ–∞—Ç—Ä—ã (dramteatr, muzteatr, sobor) | pyramida.info |
| –ó–∞–ø—É—Å–∫ | –ö–æ–º–∞–Ω–¥–∞ `/parse` | –ö–Ω–æ–ø–∫–∞ –≤ VK review |
| Pages rebuild | –î–∞, –≤ –∫–æ–Ω—Ü–µ | –ù–µ—Ç |
| Kaggle notebook | ParseTheatres | ParsePyramida |

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ü–∞—Ä—Å–∏–Ω–≥ SPA —Å–∞–π—Ç–∞ —á–µ—Ä–µ–∑ Playwright —Ç—Ä–µ–±—É–µ—Ç ~3 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è Kaggle: 15 –º–∏–Ω—É—Ç
- –û–ø–∏—Å–∞–Ω–∏–µ –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –¥–æ 1000 —Å–∏–º–≤–æ–ª–æ–≤
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–∞ Kaggle

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–õ–æ–≥–∏:
```
pyramida_kaggle: pushing kernel...
pyramida_kaggle: poll 1/45 status=RUNNING
pyramida_kaggle: complete duration=120.5s files=1
pyramida_parse: parsed file=pyramida_events.json events=3
pyramida_process: complete total=3 added=2 updated=1 failed=0
```

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

- `/vk` ‚Äî –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é VK intake
- `/parse` ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ —Ç–µ–∞—Ç—Ä–æ–≤
- `/vk_queue` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—á–µ—Ä–µ–¥–∏ VK
