from __future__ import annotations

from pathlib import Path

_ASSETS_DIR = Path(__file__).parent / "assets"
_DEFAULT_PROMPT = (
    "–°–æ–±–µ—Ä–∏ —Å—Ü–µ–Ω–∞—Ä–∏–π –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫–∞ –ø–æ —Å–ø–∏—Å–∫—É —Å–æ–±—ã—Ç–∏–π. –ò—Å–ø–æ–ª—å–∑—É–π –∂–∏–≤–æ–π —Ç–æ–Ω,"
    " –ø—Ä–∏–≤—è–∂–∏ —Ö—Ä–æ–Ω–æ–º–µ—Ç—Ä–∞–∂, —É–ø–æ–º—è–Ω–∏ –ø–ª–æ—â–∞–¥–∫—É –∏ –≤—Ä–µ–º—è."
)


def selection_response_format(max_items: int = 8) -> dict:
    return {
        "type": "json_schema",
        "json_schema": {
            "name": "VideoAnnounceRanking",
            "schema": {
                "type": "object",
                "properties": {
                    "intro_text": {"type": ["string", "null"], "maxLength": 60},
                    "items": {
                        "type": "array",
                        "maxItems": max_items,
                        "minItems": 0,
                        "items": {
                            "type": "object",
                            "properties": {
                                "event_id": {"type": "integer"},
                                "score": {"type": ["number", "null"]},
                                "reason": {"type": ["string", "null"]},
                                "about": {"type": ["string", "null"]},
                            },
                            "required": [
                                "event_id",
                                "score",
                                "reason",
                                "about",
                            ],
                            "additionalProperties": False,
                        },
                    },
                },
                "required": ["intro_text", "items"],
                "additionalProperties": False,
            },
            "strict": True,
        },
    }


FINAL_TEXT_RESPONSE_FORMAT = {
    "type": "json_schema",
    "json_schema": {
        "name": "VideoAnnounceFinalText",
        "schema": {
            "type": "object",
            "properties": {
                "items": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "event_id": {"type": "integer"},
                            "final_title": {"type": "string"},
                            "about": {"type": "string"},
                            "description": {"type": "string"},
                            "use_ocr": {"type": ["boolean", "null"]},
                            "poster_source": {"type": ["string", "null"]},
                        },
                        "required": [
                            "event_id",
                            "final_title",
                            "about",
                            "description",
                            "use_ocr",
                            "poster_source",
                        ],
                        "additionalProperties": False,
                    },
                }
            },
            "required": ["items"],
            "additionalProperties": False,
        },
        "strict": True,
    },
}


def about_fill_response_format(count: int) -> dict:
    """Response format for generating about field for events missing it."""
    return {
        "type": "json_schema",
        "json_schema": {
            "name": "VideoAnnounceAboutFill",
            "schema": {
                "type": "object",
                "properties": {
                    "items": {
                        "type": "array",
                        "minItems": count,
                        "maxItems": count,
                        "items": {
                            "type": "object",
                            "properties": {
                                "event_id": {"type": "integer"},
                                "about": {"type": "string"},
                            },
                            "required": ["event_id", "about"],
                            "additionalProperties": False,
                        },
                    }
                },
                "required": ["items"],
                "additionalProperties": False,
            },
            "strict": True,
        },
    }


def about_fill_prompt() -> str:
    """System prompt for generating about field for events."""
    return (
        "–¢—ã –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤–∏–¥–µ–æ—Ä–µ–¥–∞–∫—Ç–æ—Ä–∞. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –ø–æ–ª–µ about.\n"
        "–ö–û–ù–¢–ï–ö–°–¢: about –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ü–û–î –∞—Ñ–∏—à–µ–π –≤ –≤–∏–¥–µ–æ–∞–Ω–æ–Ω—Å–µ.\n"
        "–¶–ï–õ–¨ about: –¥–∞—Ç—å –ù–ê–ó–í–ê–ù–ò–ï —Å–æ–±—ã—Ç–∏—è + –∫—Ä–∞—Ç–∫—É—é –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ—É.\n\n"
        "–§–û–†–ú–£–õ–ê: about = title + –ø–æ–ª–µ–∑–Ω–∞—è_–∏–Ω—Ñ–∞ - –î–£–ë–õ–ò–†–£–Æ–©–ò–ï–°–Ø_—Å–ª–æ–≤–∞_–∏–∑_ocr_title\n\n"
        "–ü–†–ê–í–ò–õ–ê:\n"
        " 1. –ú–∞–∫—Å–∏–º—É–º 12 —Å–ª–æ–≤.\n"
        " 2. title (–∏–ª–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ –Ω–µ–≥–æ) –í–°–ï–ì–î–ê –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ about!\n"
        "    –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –µ—Å–ª–∏ –≠–¢–ò –ñ–ï —Å–ª–æ–≤–∞ —É–∂–µ –µ—Å—Ç—å –≤ ocr_title (–Ω–µ –Ω—É–∂–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–æ —á—Ç–æ –∑—Ä–∏—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–∞ –∞—Ñ–∏—à–µ).\n"
        " 3. –î–æ–±–∞–≤—å 1-2 –ø–æ–ª–µ–∑–Ω—ã—Ö —Å–ª–æ–≤–∞ –∏–∑ search_digest.\n"
        " 4. –ù–ï –¥—É–±–ª–∏—Ä—É–π —Å–ª–æ–≤–∞ –∏–∑ ocr_title (–∑—Ä–∏—Ç–µ–ª—å –∏—Ö —É–∂–µ –≤–∏–¥–∏—Ç –Ω–∞ –∞—Ñ–∏—à–µ).\n\n"
        "–ü–†–ò–ú–ï–†–´:\n"
        " - title='–ú—ã—Å–ª–∏ –º—É–¥—Ä—ã—Ö –ª—é–¥–µ–π', ocr_title='31 –¥–µ–∫–∞–±—Ä—è' ‚Üí about='–ú—ã—Å–ª–∏ –º—É–¥—Ä—ã—Ö –ª—é–¥–µ–π ‚Äî —Å–ø–µ–∫—Ç–∞–∫–ª—å –æ —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏'\n"
        "   (title –≤–∫–ª—é—á—ë–Ω, '31 –¥–µ–∫–∞–±—Ä—è' –Ω–µ –¥—É–±–ª–∏—Ä—É–µ–º)\n"
        " - title='–©–µ–ª–∫—É–Ω—á–∏–∫', ocr_title='–©–ï–õ–ö–£–ù–ß–ò–ö' ‚Üí about='–ë–∞–ª–µ—Ç –Ω–∞ –º—É–∑—ã–∫—É –ß–∞–π–∫–æ–≤—Å–∫–æ–≥–æ'\n"
        "   (title —É–∂–µ –Ω–∞ –∞—Ñ–∏—à–µ, –Ω–µ –¥—É–±–ª–∏—Ä—É–µ–º)\n"
        " - title='–ö–æ–Ω—Ü–µ—Ä—Ç –¥–∂–∞–∑–∞', ocr_title='' ‚Üí about='–ö–æ–Ω—Ü–µ—Ä—Ç –¥–∂–∞–∑–∞ –≤ —Ñ–∏–ª–∞—Ä–º–æ–Ω–∏–∏'\n"
        "   (ocr_title –ø—É—Å—Ç, –≤–∫–ª—é—á–∞–µ–º title –ø–æ–ª–Ω–æ—Å—Ç—å—é)\n\n"
        " 5. –ë–µ–∑ –∫–∞–≤—ã—á–µ–∫ –∏ —ç–º–æ–¥–∑–∏.\n"
        " 6. –ù–ï –ø–∏—à–∏ '–±–µ—Å–ø–ª–∞—Ç–Ω–æ', '–ø–ª–∞—Ç–Ω–æ' ‚Äî —ç—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ.\n"
        "–û—Ç–≤–µ—Ç —Å—Ç—Ä–æ–≥–æ JSON —Å items: [{event_id, about}]."
    )


def load_prompt(name: str = "script") -> str:
    """Return prompt text for the requested name, falling back to default."""

    asset = _ASSETS_DIR / f"{name}.txt"
    if asset.exists():
        return asset.read_text(encoding="utf-8").strip()
    return _DEFAULT_PROMPT


def available_prompts() -> list[str]:
    prompts = []
    for path in _ASSETS_DIR.glob("*.txt"):
        prompts.append(path.stem)
    return sorted(set(prompts + ["script"]))


def selection_prompt() -> str:
    return (
        "–¢—ã –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –≤–∏–¥–µ–æ—Ä–µ–¥–∞–∫—Ç–æ—Ä–∞. –ü–æ–ª—É—á–∏—à—å JSON —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –∏ –¥–æ–ª–∂–µ–Ω"
        " –≤—ã–±—Ä–∞—Ç—å —Å–æ–±—ã—Ç–∏—è (—Ç–æ–ª—å–∫–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º) –¥–ª—è –∫–æ—Ä–æ—Ç–∫–æ–≥–æ —Ä–æ–ª–∏–∫–∞."
        " –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ –≤—ã–ø–æ–ª–Ω–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞: –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞"
        " ‚Äî —Å–ª–µ–¥—É–π –µ–π. –í—ã–±–µ—Ä–∏ –¥–æ 8 –ª—É—á—à–∏—Ö —Å–æ–±—ã—Ç–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ–¥ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏."
        " –í–µ—Ä–Ω–∏ event_id, score (0‚Äì10) –∏ –ø—Ä–∏—á–∏–Ω—É –≤—ã–±–æ—Ä–∞ (reason, –¥–æ 120 —Å–∏–º–≤–æ–ª–æ–≤)."
        " –ù–ï –≤—ã–¥—É–º—ã–≤–∞–π —Å–æ–±—ã—Ç–∏–π, –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ candidates."
        " –ï—Å–ª–∏ —Å–æ–±—ã—Ç–∏—è –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç, –≤–µ—Ä–Ω–∏ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ items –∏–ª–∏ –º–µ–Ω—å—à–µ 8."
        " –û—Ç–≤–µ—Ç —Å—Ç—Ä–æ–≥–æ JSON."
        "\n\n–í–ê–ñ–ù–û: –ê–ù–ê–õ–ò–ó –ü–û–î–•–û–î–Ø–©–ò–• –°–û–ë–´–¢–ò–ô:"
        " 1. –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π 'title' –ò 'poster_ocr_text' –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏–∑ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏."
        " 2. –ü—Ä–∏–º–µ—Ä: –µ—Å–ª–∏ instruction='–º—É–∑—ã–∫–∞', –∏—â–∏ —Å–ª–æ–≤–∞ '–æ—Ä–∫–µ—Å—Ç—Ä', '–∫–æ–Ω—Ü–µ—Ä—Ç', '—Ö–æ—Ä', 'dj', '–≤–µ—á–µ—Ä–∏–Ω–∫–∞' –≤ title –∏ ocr."
        " 3. –î–∞–∂–µ –µ—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å–æ–±—ã—Ç–∏—è –Ω–µ–æ—á–µ–≤–∏–¥–Ω–∞ (–Ω–∞–ø—Ä. '–ö–∏–Ω–æ—Ö–∏—Ç—ã'), –Ω–∞–ª–∏—á–∏–µ —Å–ª–æ–≤–∞ '–û—Ä–∫–µ—Å—Ç—Ä' –≤ OCR –¥–µ–ª–∞–µ—Ç –µ–≥–æ –º—É–∑—ã–∫–∞–ª—å–Ω—ã–º."
        " 4. –ù–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–π —Å–æ–±—ã—Ç–∏—è, –µ—Å–ª–∏ keyword –Ω–∞–π–¥–µ–Ω —Ç–æ–ª—å–∫–æ –≤ OCR —Ç–µ–∫—Å—Ç–µ."
        "\n\n–ü–†–ê–í–ò–õ–ê –î–õ–Ø intro_text (–°–¢–†–û–ì–û):"
        " 1. –≠—Ç–æ –ó–ê–ì–û–õ–û–í–û–ö –¥–ª—è –≤–∏–¥–µ–æ. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –¶–ï–ü–õ–Ø–Æ–©–ò–ú, –ª–∞–∫–æ–Ω–∏—á–Ω—ã–º, –ø–æ–Ω—è—Ç–Ω—ã–º."
        " 2. –ò–ó–ë–ï–ì–ê–ô –¥–≤–æ–µ—Ç–æ—á–∏–π. –§–æ—Ä–º—É–ª–∏—Ä—É–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞–∫ –µ–¥–∏–Ω—É—é —Ñ—Ä–∞–∑—É."
        " 3. –î–∞—Ç—ã: —Å—Ç—Ä–æ–≥–æ –ö–ê–ü–°–û–ú, –±–µ–∑ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π (–ø–æ–ª–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Å—è—Ü–µ–≤). –§–æ—Ä–º–∞—Ç –¥–∞—Ç –ù–ï –º–µ–Ω—è–π."
        " 4. –î–ª–∏–Ω–∞ ‚â§ 60 —Å–∏–º–≤–æ–ª–æ–≤. –ë–µ–∑ —ç–º–æ–¥–∑–∏, –∫–∞–≤—ã—á–µ–∫, –≤–æ—Å–∫–ª–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤."
        " 5. '–í—ã—Ö–æ–¥–Ω—ã–µ' = —Ç–æ–ª—å–∫–æ —Å—É–±–±–æ—Ç–∞ –∏ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ! –°–º–æ—Ç—Ä–∏ –ø–æ–ª–µ day_of_week —É —Å–æ–±—ã—Ç–∏–π."
        " 6. –í–ê–ñ–ù–û: –†–ê–ó–ù–û–û–ë–†–ê–ó–¨ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏! –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π '–î–µ—Ç—Å–∫–∞—è –∞—Ñ–∏—à–∞' –∫–∞–∂–¥—ã–π —Ä–∞–∑. –ß–µ—Ä–µ–¥—É–π –ø–∞—Ç—Ç–µ—Ä–Ω—ã: '–ö—É–¥–∞ –ø–æ–π—Ç–∏ —Å –¥–µ—Ç—å–º–∏', '5 —Å–æ–±—ã—Ç–∏–π –¥–ª—è —Å–µ–º—å–∏', '–î–ª—è –¥–µ—Ç–µ–π –∏ –≤–∑—Ä–æ—Å–ª—ã—Ö' –∏ —Ç.–¥."
        "\n\n   –ö–ê–¢–ï–ì–û–†–ò–ò –ü–ê–¢–¢–ï–†–ù–û–í (–≤—ã–±–∏—Ä–∞–π –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ instruction):"
        "\n\n   üü¢ –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ï (–ø–æ–ª—å–∑–∞, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ):"
        "\n   - –ö—É–¥–∞ —Å—Ö–æ–¥–∏—Ç—å –î–ê–¢–´"
        "\n   - –ö—É–¥–∞ –ø–æ–π—Ç–∏ –î–ê–¢–´"
        "\n   - –ì–ª–∞–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –î–ê–¢–´"
        "\n   - –ê—Ñ–∏—à–∞ –î–ê–¢–´"
        "\n   - –ü–ª–∞–Ω—ã –Ω–∞ –î–ê–¢–´"
        "\n   - –ì–∏–¥ –ø–æ —Å–æ–±—ã—Ç–∏—è–º –î–ê–¢–´"
        "\n   - –ö–∞–∫ –ø—Ä–æ–≤–µ—Å—Ç–∏ –î–ê–¢–´"
        "\n   - –ü–æ–¥–±–æ—Ä–∫–∞ —Å–æ–±—ã—Ç–∏–π –î–ê–¢–´"
        "\n   - –ì–¥–µ –æ—Ç–¥–æ—Ö–Ω—É—Ç—å –î–ê–¢–´"
        "\n   - –°–æ–±—ã—Ç–∏—è –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç –ø–æ—Å–µ—Ç–∏—Ç—å"
        "\n   - –ú–∞—Ä—à—Ä—É—Ç –Ω–∞ –î–ê–¢–´"
        "\n   - –ß–µ–º –∑–∞–Ω—è—Ç—å—Å—è –î–ê–¢–´"
        "\n   - –ö—É–ª—å—Ç—É—Ä–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –î–ê–¢–´"
        "\n\n   üë§ –î–û–í–ï–†–ò–¢–ï–õ–¨–ù–´–ï (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è, –ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä):"
        "\n   - –ú–æ–π –≤—ã–±–æ—Ä –Ω–∞ –î–ê–¢–´"
        "\n   - –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ—Å–µ—Ç–∏—Ç—å –î–ê–¢–´"
        "\n   - –°–æ–±—Ä–∞–ª –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∞—Ñ–∏—à—É"
        "\n   - –î–µ–ª—é—Å—å –Ω–∞—Ö–æ–¥–∫–∞–º–∏ –î–ê–¢–´"
        "\n   - –ß—Ç–æ —Å—Ç–æ–∏—Ç –≤–Ω–∏–º–∞–Ω–∏—è –î–ê–¢–´"
        "\n   - –ò–¥–µ–∏ –¥–ª—è –æ—Ç–¥—ã—Ö–∞ –î–ê–¢–´"
        "\n   - –í–∞—Ä–∏–∞–Ω—Ç—ã –¥–æ—Å—É–≥–∞ –î–ê–¢–´"
        "\n\n   üé≠ –¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ò–ï (–ø–æ–¥—á—ë—Ä–∫–∏–≤–∞—é—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –∏–ª–∏ —Ç–µ–º—É):"
        "\n   - –î–ª—è –¥–µ—Ç–µ–π –∏ –≤–∑—Ä–æ—Å–ª—ã—Ö –î–ê–¢–´"
        "\n   - –°–µ–º–µ–π–Ω—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –î–ê–¢–´"
        "\n   - –ú—É–∑—ã–∫–∞ –∏ —Ç–µ–∞—Ç—Ä –î–ê–¢–´"
        "\n   - –û—Ç —Ä–æ–∫–∞ –¥–æ –∫–ª–∞—Å—Å–∏–∫–∏ –î–ê–¢–´"
        "\n   - –ö–æ–Ω—Ü–µ—Ä—Ç—ã –∏ —Å–ø–µ–∫—Ç–∞–∫–ª–∏ –î–ê–¢–´"
        "\n   - –ò—Å–∫—É—Å—Å—Ç–≤–æ –∏ –æ—Ç–¥—ã—Ö –î–ê–¢–´"
        "\n   - –ö—É–ª—å—Ç—É—Ä–Ω—ã–π –º–∏–∫—Å –î–ê–¢–´"
        "\n   - –î–µ—Ç—Å–∫–∞—è –∞—Ñ–∏—à–∞ –î–ê–¢–´"
        "\n   - –¢–µ–∞—Ç—Ä–∞–ª—å–Ω—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ –î–ê–¢–´"
        "\n\n   üìä –° –ö–û–õ–ò–ß–ï–°–¢–í–û–ú (–∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞):"
        "\n   - N —Å–æ–±—ã—Ç–∏–π –î–ê–¢–´ (5 —Å–æ–±—ã—Ç–∏–π 24 –î–ï–ö–ê–ë–†–Ø)"
        "\n   - N –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤ –î–ê–¢–´ (5 –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤ –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ)"
        "\n   - N —Å–ø–µ–∫—Ç–∞–∫–ª–µ–π –î–ê–¢–´"
        "\n   - N –∏–¥–µ–π –¥–ª—è –æ—Ç–¥—ã—Ö–∞ –î–ê–¢–´"
        "\n   - –¢–æ–ø N —Å–æ–±—ã—Ç–∏–π –î–ê–¢–´"
        "\n\n   üì± –ö–û–†–û–¢–ö–ò–ï (–¥–ª—è –Ω–∞–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –≤–∏–¥–µ–æ):"
        "\n   - –ö—É–¥–∞ —Å—Ö–æ–¥–∏—Ç—å"
        "\n   - –ü–ª–∞–Ω—ã –Ω–∞ –Ω–µ–¥–µ–ª—é"
        "\n   - –¢–æ–ø —Å–æ–±—ã—Ç–∏–π"
        "\n   - –ì–∏–¥ –ø–æ –≤—ã—Ö–æ–¥–Ω—ã–º"
        "\n   - –õ—É—á—à–∏–µ –º–µ—Å—Ç–∞"
        "\n   - –í—ã–±–æ—Ä –Ω–µ–¥–µ–ª–∏"
        "\n   - –ì–ª–∞–≤–Ω–æ–µ –î–ê–¢–´"
        "\n   - –õ—É—á—à–µ–µ –î–ê–¢–´"
        "\n\n   5. –ö–†–ï–ê–¢–ò–í –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç—Å—è! –£—á–∏—Ç—ã–≤–∞–π —Ç–µ–º—É –∏–∑ instruction –∏ —Å–æ—Å—Ç–∞–≤ –≤—ã–±–æ—Ä–∫–∏."
        "\n   6. –ü—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤:"
        "\n      - –ö—É–¥–∞ –ø–æ–π—Ç–∏ 25-27 –î–ï–ö–ê–ë–†–Ø"
        "\n      - 5 –∫–æ–Ω—Ü–µ—Ä—Ç–æ–≤ –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ"
        "\n      - –î–µ—Ç—Å–∫–∞—è –∞—Ñ–∏—à–∞ 28-30 –î–ï–ö–ê–ë–†–Ø"
        "\n      - –ì–ª–∞–≤–Ω–æ–µ –∑–∞ —ç—Ç—É –Ω–µ–¥–µ–ª—é"
        "\n      - –ü–ª–∞–Ω—ã –Ω–∞ –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ –∫–∞–Ω–∏–∫—É–ª—ã"
        "\n      - –ö—É–¥–∞ —Å—Ö–æ–¥–∏—Ç—å —Å –¥–µ—Ç—å–º–∏ 25 –î–ï–ö–ê–ë–†–Ø"
        "\n      - 6 —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤—Å–µ–π —Å–µ–º—å–∏"
        "\n      - –¢–µ–∞—Ç—Ä–∞–ª—å–Ω–∞—è –∞—Ñ–∏—à–∞ 27-29 –î–ï–ö–ê–ë–†–Ø"
        "\n      - –õ—É—á—à–µ–µ –Ω–∞ —ç—Ç–∏ –≤—ã—Ö–æ–¥–Ω—ã–µ"
        "\n      - –ú—É–∑—ã–∫–∞ –∏ —Ç–µ–∞—Ç—Ä 25-31 –î–ï–ö–ê–ë–†–Ø"
        "\n      - –ú–æ–π –≤—ã–±–æ—Ä –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ"
        "\n      - –ì–∏–¥ –ø–æ —Å–æ–±—ã—Ç–∏—è–º —è–Ω–≤–∞—Ä—è"
        "\n      - –°–µ–º–µ–π–Ω—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ 28-29 –î–ï–ö–ê–ë–†–Ø"
        "\n      - –ö–æ–Ω—Ü–µ—Ä—Ç—ã –∏ —Å–ø–µ–∫—Ç–∞–∫–ª–∏ –Ω–∞ –Ω–µ–¥–µ–ª—é"
        "\n\n–ü–†–ê–í–ò–õ–ê –î–õ–Ø about (–¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è):"
        "\n about –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ü–û–î –∞—Ñ–∏—à–µ–π. –¶–µ–ª—å: –¥–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ + –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ—É."
        "\n 1. –ú–∞–∫—Å–∏–º—É–º 12 —Å–ª–æ–≤. –õ–∞–∫–æ–Ω–∏—á–Ω–æ, –∑–∞–ø–æ–º–∏–Ω–∞–µ–º–æ."
        "\n 2. –§–æ—Ä–º—É–ª–∞: about = title + –∏–Ω—Ñ–∞_–∏–∑_search_digest - —Å–ª–æ–≤–∞_–∏–∑_ocr_title."
        "\n 3. –ï—Å–ª–∏ ocr_title –ù–ï –ø—É—Å—Ç–æ–π: –ù–ï –¥—É–±–ª–∏—Ä—É–π –µ–≥–æ —Å–ª–æ–≤–∞. –ù–æ –í–ö–õ–Æ–ß–ò —Å–ª–æ–≤–∞ –∏–∑ title, –∫–æ—Ç–æ—Ä—ã—Ö –ù–ï–¢ –≤ ocr_title."
        "\n 4. –ï—Å–ª–∏ ocr_title –ü–£–°–¢: about –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø —Å title (–∏–ª–∏ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏–∑ –Ω–µ–≥–æ)!"
        "\n 5. –ë–µ–∑ –∫–∞–≤—ã—á–µ–∫ –∏ —ç–º–æ–¥–∑–∏."
        "\n 6. –ù–ï –ø–∏—à–∏ '–±–µ—Å–ø–ª–∞—Ç–Ω–æ', '–ø–ª–∞—Ç–Ω–æ', '–≤—Ö–æ–¥ —Å–≤–æ–±–æ–¥–Ω—ã–π' ‚Äî —ç—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ."
    )


def finalize_prompt() -> str:
    return (
        "–¢—ã –ø–æ–º–æ–≥–∞–µ—à—å —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –∞—Ñ–∏—à–∏"
        " –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫–∞. –£ –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –µ—Å—Ç—å title, search_digest (—Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ), description"
        " –∏ OCR –¥–∞–Ω–Ω—ã–µ (ocr_title, poster_text). "
        "–ü–æ–ª–µ about: –º–∞–∫—Å–∏–º—É–º 12 —Å–ª–æ–≤, –±–µ–∑ —ç–º–æ–¥–∑–∏/–∫–∞–≤—ã—á–µ–∫. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø–æ–º–∏–Ω–∞–µ–º—ã–º –∏ –æ—Ç–ª–∏—á–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ."
        " –í–∫–ª—é—á–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ title, –∫—Ä–æ–º–µ —Ç–µ—Ö, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ ocr_title (–∑—Ä–∏—Ç–µ–ª—å –∏—Ö –∏ —Ç–∞–∫ –≤–∏–¥–∏—Ç)."
        " –î–æ–±–∞–≤–ª—è–µ—Ç 1‚Äì2 '—Ñ–∏—à–∫–∏' –∏–∑ search_digest (–∏–ª–∏ description), —á—Ç–æ–±—ã –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞—Ç—å."
        " –ù–ï –ø–æ–≤—Ç–æ—Ä—è–µ—Ç —Å–ª–æ–≤–∞ –∏–∑ ocr_title. –ï—Å–ª–∏ ocr_title –ø—É—Å—Ç–æ–π ‚Äî –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–π—Å—è –Ω–∞ title."
        " –ü–æ–ª–µ final_title: —Ü–µ–ø–ª—è—é—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ 12 —Å–∏–º–≤–æ–ª–æ–≤."
        " –û—Ç–≤–µ—Ç —Å—Ç—Ä–æ–≥–æ JSON —Å –ø–æ–ª—è–º–∏ event_id, final_title, about, description, use_ocr, poster_source."
    )
