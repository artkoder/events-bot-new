Skills: специализированные скиллы не применял (есть только creator/installer).

**Telegraph лимиты/троттлинг**
- Размер страниц ограничен `TELEGRAPH_LIMIT = 45000` байт (≈64 kB минус запас) — используется при сборке/сплите месяцев (`main.py:1476`, `main_part2.py:571`).  
- Вызовы create/edit идут через `telegraph_call`: таймаут 30 c (`TELEGRAPH_TIMEOUT`), до 3 попыток с backoff 1/2/4 c на таймаутах, выполнение в thread + `asyncio.wait_for`, единичная конкуррентность через `TELEGRAPH_SEMAPHORE` (env `TELEGRAPH_CONCURRENCY`, по умолчанию 1) (`main.py:1526`, `main.py:1826-1865`).  
- Дополнительно страницы дебаунсятся по 60 c, но force=true в `/pages_rebuild` отключает это (`main_part2.py:981-988`, `main_part2.py:5715`).

**Flood‑protection**
- Единственная явная защита: regex на ответ «Flood control exceeded… Retry in N seconds» с ожиданием `N+1` и повтором (`main.py:1856-1864`).  
- Глобальный семафор + per-page locks (`_page_locks`) исключают параллельные правки одной страницы, снижая шанс 429 (`main.py:288`, `main_part2.py:745`, `main_part2.py:1113`). Других механизмов (rate window, jitter) нет.

**Риски при массовых ребилдах (10+ страниц)**
- Все create/edit идут последовательно, поэтому при серии из десятков вызовов попадаем в flood sleep → общее время резко растёт; при превышении лимитов/сетевых глюках попыток всего 3.  
- Ошибки Telegraphexception (кроме flood) не ретраятся и помечают месяц/уикенд как failed; автоматического повторного прогона нет (`main_part2.py:3638-3706`).  
- Weekend-посты не проверяют размер против `TELEGRAPH_LIMIT`; крупные уикенды могут упасть прямо в `telegraph_edit_page` (`main_part2.py:980-1100`).  
- Во время `_perform_pages_rebuild` включён `DISABLE_EVENT_PAGE_UPDATES` → события без готового telegraph_url подставят исходный пост вместо Telegraph, что даёт несогласованные ссылки после массового ребилда (`main_part2.py:5717`).  
- При создании/обновлении навигации месяца, если обновлённый HTML > лимита, происходит fallback на полный ребилд; но если и он не влезет, ребилд падает (сейчас без отдельной страховки) (`main_part2.py:520-660`).

**Edge cases провала pages_rebuild**
- Нет токена — RuntimeError/return и весь месяц/уикенд помечается failed (`main_part2.py:996-999`, `main_part2.py:567/520`).  
- Ошибки Telegrapha не содержащие «Flood control…» не ретраятся; HTTP 5xx/429 в другом формате тоже.  
- Weekend-страницы с большими текстами/обложками могут превысить лимит и упасть без сплита.  
- Навигационное обновление месяцев может превысить лимит: триггерит полный rebuild, но без доп. попыток (если всё ещё > лимита).  
- Репорты отправляются в чат, но нет алерта/перезапуска на failed, поэтому падения остаются ручными.

**Как сделать ребилд надёжным**
- Добавить явный preflight по размеру weekend HTML + fallback (сжатый режим/обрезка) аналогично месячным страницам.  
- Расширить retry: ловить HTTP 429/5xx, добавлять общий джиттер/паузы между страницами при больших сериях, повышать retries для `/pages_rebuild` ручного запуска.  
- Делать перезапланированные повторы для failed месяцев/уикендов (например, очередь с max_attempts, задержкой flood_wait+джиттер).  
- Логирование/алерты: сводка failed страниц в отдельный канал + метрики (время, размер, причину). Сейчас отчёт только в чат инициатора.  
- После массового ребилда (где `DISABLE_EVENT_PAGE_UPDATES`) запускать отдельную очередь на восстановление event Telegraph ссылок, чтобы страницы ссылаются на Telegraph, а не на исходники.  
- Для больших батчей запускать rebuild чанками (например, по 3–5 месяцев) с паузой, чтобы не накопить flood-wait.